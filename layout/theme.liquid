<!DOCTYPE html>
<!--[if IE 7]><html class="no-js ie7 lt-ie8 lt-ie9 lt-ie10" lang="en"> <![endif]-->
<!--[if IE 8]><html class="no-js ie8 lt-ie9 lt-ie10" lang="en"> <![endif]-->
<!--[if IE 9]><html class="no-js ie9 lt-ie10"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
<head>

    <script>
      {% if customer.tags.size > 0 %}
        window.upsell_customer_tags = "{{customer.tags |join: ','}}";
      {% endif %}
    </script>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  {% capture protocol %}{{ 'reset.css' | asset_url | truncate: 5, '' }}{% endcapture %}
  {% if protocol =='https' %}<meta name="robots" content="noindex, follow" />{% endif %}
  {% if template contains 'page.nofollow' %}
	<meta name="robots" content="noindex">
  {% endif %}
  <title>
    {{ page_title }}
    {% if current_tags %}
      &ndash; {{ 'blogs.blog.seo_title' | t }} "{{ current_tags | join: ', ' }}"
    {% endif %}
    {% if current_page != 1 %}
      &ndash; {{ 'general.pagination.seo_title' | t }} {{ current_page }}
    {% endif %}
	{% comment %}
        {% unless page_title contains shop.name %}
          &ndash; {{ shop.name }}
        {% endunless %}
	{% endcomment %}
  </title>
  {% if page_description %}
    <meta name="description" content="{{ page_description | escape }}" />
  {% endif %}
  <meta name="google-site-verification" content="GBKzMQ1rE7FUqqwiOZV1-nLnJC5SuEfI7cbQvzUDQv0" />
  <meta name="msvalidate.01" content="ACA0CE5C9B4A929A69729E2E7D41B8D2" />
  <link rel="shortcut icon" href="{{ 'favicon.ico' | asset_url }}" type="image/x-icon" />
  <link rel="canonical" href="{{ canonical_url }}" />
  <meta name="viewport" content="width=device-width" />
  {{ content_for_header }}
  {% include 'social-meta' %}
  <!-- Theme CSS -->
  {{ 'theme.scss.css' | asset_url | stylesheet_tag }}
  <!-- Add media query support to IE8 -->
  <!--[if lt IE 9]>
  <script src="{{ 'respond.min.js' | asset_url }}"></script>
  <link href="{{ 'respond-proxy.html' | asset_url | split: '?' | first }}" id="respond-proxy" rel="respond-proxy" />
  {% assign respond_js_secret_key = shop.domain | md5 %}
  <link href="//{{ shop.domain }}/search?q={{ respond_js_secret_key }}" id="respond-redirect" rel="respond-redirect" />
  <script src="//{{ shop.domain }}/search?q={{ respond_js_secret_key }}" type="text/javascript"></script>
  <![endif]-->
  <!-- Theme object -->
  {% include 'theme-options' %}
  {% if settings.custom-css != blank %}
    <!-- Custom CSS -->
    <style>
      {{ settings.custom-css }}
    </style>
  {% endif %}
  <script>
    {% comment %}
    var today = new Date(); // Today's Date

    // Important Dates
    var December1st = new Date(2016, 11, 1);// 12/1/2016
    var NewYearsEve = new Date(2017, 0, 1, 0, 0, 0);// 1/1/2017 00:00:00
    var WeekAfterNY = new Date(2017, 0, 13, 0, 0, 0);// 1/13/2017 00:00:00
	{% endcomment %}    
    
    {% if template contains 'product' %}
    	var prodHand = "{{ product.handle }}";
    {% endif %}

  </script>
</head>
{% assign sidebar = false %}
{% if settings.enable-sidebar == 'all' %}
  {% if template contains 'index' %}
    {% assign sidebar = true %}
  {% elsif template contains 'collection' %}
    {% assign sidebar = true %}
  {% endif %}
{% elsif settings.enable-sidebar == 'not-home' and template contains 'collection' %}
  {% assign sidebar = true %}
{% endif %}
<body class="{% if customer %}customer-logged-in{% endif %} sidebar-{% if sidebar %}enabled{% else %}disabled{% endif %} template-{{ template | replace: '.', ' ' | truncatewords: 1, '' | handle }}">
  {% if template contains 'index' %}
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
       var js, fjs = d.getElementsByTagName(s)[0];
       if (d.getElementById(id)) return;
       js = d.createElement(s); js.id = id;
       js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.4";
       fjs.parentNode.insertBefore(js, fjs);
     }(document, 'script', 'facebook-jssdk'));
    </script>
  {% endif %}
  {% include 'header' %}
  <div class="main-content-wrapper">
    {% unless template contains 'index' %}
      <div class="page-header">
        {% include 'page-header' %}
      </div>
    {% endunless %}
    <div class="main-content">
      {{ content_for_layout }}
    </div>
    {% if sidebar %}
      {% include 'sidebar' %}
    {% endif %}
  </div>
  {% include 'footer' %}



{% comment %}==========================================================================================================================={% endcomment %}
{% comment %}= Scripts =================================================================================================================={% endcomment %}
{% comment %}==========================================================================================================================={% endcomment %}
  {{ 'scripts-combined.js' | asset_url | script_tag }}
  {{ 'api.jquery.js' | shopify_asset_url | script_tag }}
  {% if template contains 'cart' %}
    {% if settings.cart-shipping-calculator %}
      {{ "https://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js" | script_tag }}
      {{ "/services/javascripts/countries.js" | script_tag }}
      {{ "shopify_common.js" | shopify_asset_url | script_tag }}
    {% endif %}
    {{ 'jquery.cart.min.js' | asset_url | script_tag }}
  {% endif %}
  {% if template contains 'customers' %}
    {{ 'shopify_common.js' | shopify_asset_url | script_tag }}
    {{ 'customer_area.js'  | shopify_asset_url | script_tag }}
  {% endif %}
  {% if settings.enable-currency-switcher %}
    {{ "//cdn.shopify.com/s/javascripts/currencies.js" | script_tag }}
    {{ "jquery.currencies.js" | asset_url | script_tag }}
  {% endif %}
  {% if template contains 'product' %}{% comment %} If we are on a product page{% endcomment %}
    {% comment %}{{ 'option_selection.js' | shopify_asset_url | script_tag }}{% endcomment %}
  	{{ 'option_selection.js' | asset_url | script_tag }}
  	<script>
      function tagExists(theProduct, theTag)/*check if a product has a tag*/
      {
        /*console.log("Searching for "+theTag+"...");*/
        for(i = 0 ; i < theProduct.tags.length ; i++)
        {
          if(theTag == theProduct.tags[i])
          {
            /*console.log("Found.");*/
            return true;
          }
        }
        /*console.log("Not Found.");*/
        return false;
      }
      
      function updateInv(product)/*inventory display updater*/
      {
          console.log('updating stock...');
          			
          var varID = $.urlParam('variant');/*grab variant value from url*//*console.log('Var ID: ' +varID);*/
          var varNum = 0;/*variable for location of selected variant in array*/
        
          if(tagExists(product, "Archive"))/*if archived*/
          {
              /*no need to display stock*/
              /*console.log('Archived. Stock not being displayed.');*/
	          $('.prodship').remove();/*remove inventory info*/
              return;
          }
        
          if(varID !== null)/*if variant is chosen*/
		  {
              /*console.log('Variant Chosen');*/
              for(i = 0 ; i < product.variants.length ; i++)/*search for variant in variant array*/
              {
              		if(product.variants[i].id == varID)/*if variant is found*/
                    {
                      	varNum = i;/*record variant location in variant array*/
                      	/*console.log("Variant Number: "+varNum);*/
                      	break;/*exit loop*/
                    }
              }
          }
          else/*no variant is chosen*/
          {
              /*console.log('Variant NOT Chosen');*/
          }
        
          if(product.available)/*if the product is available for purchase*/
          {
              /*console.log(product.variants[varNum]);
              console.log('Inv Quan: '+product.variants[varNum].inventory_quantity);*/

              /*inventory*/
              if(product.variants[varNum].inventory_quantity < 11 && product.variants[varNum].inventory_quantity > 1)/*if the inventory is between 1 and 11*/
              {
                /*console.log('Stock: 1 < x < 11');*/
                $('.prodinv').removeClass("red").addClass("green");
                $('.prodinv').html(product.variants[varNum].inventory_quantity + ' in stock.');/*display inventory*/
              }
              else if(product.variants[varNum].inventory_quantity == 1)/*if there is one left*/
              {
                /*console.log('Stock: 1');*/
                $('.prodinv').removeClass("red").addClass("green");
                $('.prodinv').html('Only 1 in stock.');/*display inventory*/
              }
              else if(product.variants[varNum].inventory_quantity <= 0 && (tagExists(product, "Pre-Order") || tagExists(product, "Back Order") || tagExists(product, "Custom Order")))/*if there is no stock and it is special order*/
              {
                /*console.log('Stock: <= 0 & Special Order');*/
                $('.prodinv').removeClass("red").addClass("green");
                $('.prodinv').html('Available to order.');/*display inventory*/
              }
              else/*10 or more are available or overselling is allowed*/
              {
                /*console.log('Stock: 10+ or Overselling');*/
                $('.prodinv').removeClass("red").addClass("green");
                $('.prodinv').html('In stock.');/*display that it is in stock*/
              }
            
              /*lets update that variant sku*/
              $('#variant-sku').html(product.variants[varNum].sku);
            
              var dateInfo = false;/*track whether there is date info or not*/
              
              /*time to update that handling time*/
              if(tagExists(product, "Pre-Order") && product.variants[varNum].inventory_policy == "continue")/*check if the product is pre-order and is allowed to oversell*/
              {/*if it is it must be in pre-order mode*/
                for(i = 0 ; i < product.tags.length ; i++)/*search the tags*/
                {
                  if(product.tags[i].indexOf("Releases ") != -1)/*if we have found the release info*/
                  {
                    var tagtemp = product.tags[i];
                    tagtemp=tagtemp.replace("Releases ","")/*remove the "Release" keyword from the tag*/
                    $('.prodhand').html('Releases: ' + tagtemp);/*update the release info on the page*/
                    dateInfo = true;/*release info was found*/
                    break;
                  }
                }
                if(dateInfo == false)/*if no release date was found*/
                {
                  $('.prodhand').html('Releases: Call For More Info');/*let the customer know they should call for more info about release times*/
                }
              }
              else if(tagExists(product, "Back Order") && product.variants[varNum].inventory_policy == "continue")/*check if the product is a back order item and it is allowed to oversell*/
              {
                for(i = 0 ; i < product.tags.length ; i++)/*search the tags*/
                {
                  if(product.tags[i].indexOf("Back In Stock ") != -1)/*if we have found the back order info*/
                  {
                    var tagtemp = product.tags[i];
                    tagtemp=tagtemp.replace("Back In Stock ","")/* remove "Back In Stock" keyword from the tag*/
                    $('.prodhand').html('Back In Stock: ' + tagtemp);/*update the back in stock info on the page*/
                    dateInfo = true;/*back in stock info was found*/
                    break;
                  }
                }
                if(dateInfo == false)/*if back in stocck info was not found*/
                {
                  $('.prodhand').html('Back In Stock: Call For More Info');/*let the customer know they should call for more info about back in stock date*/
                }
              }
              else if(tagExists(product, "Used Guns") && product.variants[varNum].inventory_quantity >= 1 || product.variants[varNum].inventory_quantity >= 1)/*if the product is in stock and is a used gun or it is just in stock*/
              {
                $('.prodhand').html('Estimated handling time: 1-2 business days.');/*show 1-2 day handling*/
              }
              else if(tagExists(product, "Call For"))/*if the item is tagged "Call For"*/
              {
                $('.prodhand').html('Call for shipping & handling time.');/*let customer know they need to call for shipping & handling time*/
              }
              else if(product.variants[varNum].inventory_quantity <= 0 && product.variants[varNum].inventory_policy == "continue")/*if a product is out of stock and overselling is allowed*/
              {
                var found = false;/*variable for  keeping track of whether or not a handling time was found*/
                for(i = 0 ; i < product.tags.length ; i++)/*search tags*/
                {
                  if(product.tags[i].indexOf("Hours ") != -1 || product.tags[i].indexOf("Days ") != -1 || product.tags[i].indexOf("Weeks ") != -1 || product.tags[i].indexOf("Months ") != -1 || product.tags[i].indexOf("Years ") != -1)/*if handling time info is found*/
                  {
                    $('.prodhand').html('Estimated handling time: ' + product.tags[i]);/*let customer know handling times*/
                    found = true;/*take note that a handling time was fonud*/
                    break;
                  }
                }
                if(found == false)/*if a handling time was not found*/
                {
                  $('.prodhand').html('Estimated handling time: 3-4 business days.');/*display default handling time*/
                }
              }
              else/*somehow we got here and no handling info applied*/
              {
                $('.prodship').remove();/*remove inventory info*/
              }
          }
          else/*product not available*/
          {
            $('.prodship').remove();/*remove inventory info*/
          }
          /*console.log('===========================================================================');*/
      }
	  jQuery.getJSON('/products/'+prodHand+'.js', function(product){updateInv(product)});/*update inventory*/
 	</script>
  {% endif %}
  {{ 'theme.min.js' | asset_url | script_tag }}
{% comment %}==========================================================================================================================={% endcomment %}
{% comment %}==========================================================================================================================={% endcomment %}
{% comment %}==========================================================================================================================={% endcomment %}



{% comment %}==========================================================================================================================={% endcomment %}
{% comment %}= Style Tweaks =============================================================================================={% endcomment %}
{% comment %}==========================================================================================================================={% endcomment %}
<style>
  {% comment %} Livesearch style tweaks {% endcomment %}
   .ls-footer > .ls-poweredby {
     display: none;
   }
   .ls-footer.ls-poweredby {
     width: 0%;
   }
   .ls-footer {
     width: 100%;
   }
   .ls-dropdown-menu {
     margin-top: -2px;
   }
</style>
{% comment %}==========================================================================================================================={% endcomment %}
{% comment %}==========================================================================================================================={% endcomment %}
{% comment %}==========================================================================================================================={% endcomment %}
  
<!-- Bold: CSP Step 1 (theme) -->
<script type="text/javascript" charset="utf-8">
var shappify_customer_tags ={{ customer.tags|json }}
</script>
<!-- // end bold code -->

{% include 'zopim' %}

<!-- BEEKETINGSCRIPT CODE START -->{% include 'bk-tracking' %}<!-- BEEKETINGSCRIPT CODE END --><script src="//www.codeblackbelt.com/js/modules/also-bought/main.min.js?shop=yourpbfriend-register.myshopify.com"></script>
</body>
</html>